<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>QMutexLocker &mdash; PySide 1.2.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/pysidedocs.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="PySide 1.2.1 documentation" href="../../index.html" />
    <link rel="up" title="PySide.QtCore" href="index.html" />
    <link rel="next" title="QMutex" href="QMutex.html" />
    <link rel="prev" title="QReadWriteLock" href="QReadWriteLock.html" /> 
  </head>
  <body>
<div id="container">
<div class="header">
    <div class="header_container">
        <div class="logo"><a href="http://www.pyside.org"><img alt="PySide" src="../../_static/pysidelogo.png" width="199" height="102" /></a></div>
        <div class="related">
            <ul>
                <li><a href="../../index.html">PySide 1.2.1 documentation</a></li>
                <li> &raquo; <a href="../../modules.html" >PySide modules</a></li>
                <li> &raquo; <a href="index.html" accesskey="U">PySide.QtCore</a></li> 
            </ul>
        </div>
    </div>
</div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">QMutexLocker</a><ul>
<li><a class="reference internal" href="#synopsis">Synopsis</a><ul>
<li><a class="reference internal" href="#functions">Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#detailed-description">Detailed Description</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="QReadWriteLock.html"
                        title="previous chapter">QReadWriteLock</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="QMutex.html"
                        title="next chapter">QMutex</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" id="q" size="18" />
      <input type="submit" value="Go" id="search_button" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <span class="target" id="module-PySide.QtCore"></span><div class="section" id="qmutexlocker">
<span id="id1"></span><h1>QMutexLocker<a class="headerlink" href="#qmutexlocker" title="Permalink to this headline">¶</a></h1>
<div class="section" id="synopsis">
<h2>Synopsis<a class="headerlink" href="#synopsis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>def <a class="reference internal" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.__enter__" title="PySide.QtCore.PySide.QtCore.QMutexLocker.__enter__"><tt class="xref py py-meth docutils literal"><span class="pre">__enter__</span></tt></a> ()</li>
<li>def <a class="reference internal" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.__exit__" title="PySide.QtCore.PySide.QtCore.QMutexLocker.__exit__"><tt class="xref py py-meth docutils literal"><span class="pre">__exit__</span></tt></a> (arg__1, arg__2, arg__3)</li>
<li>def <a class="reference internal" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.mutex" title="PySide.QtCore.PySide.QtCore.QMutexLocker.mutex"><tt class="xref py py-meth docutils literal"><span class="pre">mutex</span></tt></a> ()</li>
<li>def <a class="reference internal" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.relock" title="PySide.QtCore.PySide.QtCore.QMutexLocker.relock"><tt class="xref py py-meth docutils literal"><span class="pre">relock</span></tt></a> ()</li>
<li>def <a class="reference internal" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.unlock" title="PySide.QtCore.PySide.QtCore.QMutexLocker.unlock"><tt class="xref py py-meth docutils literal"><span class="pre">unlock</span></tt></a> ()</li>
</ul>
</div>
</div>
<div class="section" id="detailed-description">
<h2>Detailed Description<a class="headerlink" href="#detailed-description" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> class is a convenience class that simplifies locking and unlocking mutexes.</p>
<p>Locking and unlocking a <a class="reference internal" href="QMutex.html#PySide.QtCore.QMutex" title="PySide.QtCore.QMutex"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutex</span></tt></a> in complex functions and statements or in exception handling code is error-prone and difficult to debug. <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> can be used in such situations to ensure that the state of the mutex is always well-defined.</p>
<p><a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> should be created within a function where a <a class="reference internal" href="QMutex.html#PySide.QtCore.QMutex" title="PySide.QtCore.QMutex"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutex</span></tt></a> needs to be locked. The mutex is locked when <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> is created. You can unlock and relock the mutex with <tt class="docutils literal"><span class="pre">unlock()</span></tt> and <tt class="docutils literal"><span class="pre">relock()</span></tt> . If locked, the mutex will be unlocked when the <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> is destroyed.</p>
<p>For example, this complex function locks a <a class="reference internal" href="QMutex.html#PySide.QtCore.QMutex" title="PySide.QtCore.QMutex"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutex</span></tt></a> upon entering the function and unlocks the mutex at all the exit points:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">complexFunction</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="n">mutex</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>

    <span class="n">retVal</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">mutex</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">moreComplexFunction</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">anotherFunction</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">status</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">mutex</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">2</span>
        <span class="n">retVal</span> <span class="o">=</span> <span class="n">status</span> <span class="o">+</span> <span class="n">flag</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flag</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">mutex</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="n">mutex</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">retVal</span>
</pre></div>
</div>
<p>This example function will get more complicated as it is developed, which increases the likelihood that errors will occur.</p>
<p>Using <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> greatly simplifies the code, and makes it more readable:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">complexFunction</span><span class="p">(</span><span class="n">flag</span><span class="p">):</span>
    <span class="n">locker</span> <span class="o">=</span> <span class="n">QMutexLocker</span><span class="p">(</span><span class="n">mutex</span><span class="p">)</span>

    <span class="n">retVal</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">moreComplexFunction</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">flag</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">anotherFunction</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">status</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="o">-</span><span class="mi">2</span>
            <span class="n">retVal</span> <span class="o">=</span> <span class="n">status</span> <span class="o">+</span> <span class="n">flag</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">flag</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">return</span> <span class="n">retVal</span>
</pre></div>
</div>
<p>Now, the mutex will always be unlocked when the <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> object is destroyed (when the function returns since <tt class="docutils literal"><span class="pre">locker</span></tt> is an auto variable).</p>
<p>The same principle applies to code that throws and catches exceptions. An exception that is not caught in the function that has locked the mutex has no way of unlocking the mutex before the exception is passed up the stack to the calling function.</p>
<p><a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> also provides a <tt class="docutils literal"><span class="pre">mutex()</span></tt> member function that returns the mutex on which the <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> is operating. This is useful for code that needs access to the mutex, such as <a class="reference internal" href="QWaitCondition.html#PySide.QtCore.PySide.QtCore.QWaitCondition.wait" title="PySide.QtCore.PySide.QtCore.QWaitCondition.wait"><tt class="xref py py-meth docutils literal"><span class="pre">QWaitCondition.wait()</span></tt></a> . For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SignalWaiter</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">mutex</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locker</span> <span class="o">=</span> <span class="n">mutex</span>

    <span class="k">def</span> <span class="nf">waitForSignal</span><span class="p">():</span>
        <span class="c"># ...</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">signalled</span><span class="p">:</span>
            <span class="n">waitCondition</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">locker</span><span class="o">.</span><span class="n">mutex</span><span class="p">())</span>
        <span class="c"># ...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="QReadLocker.html#PySide.QtCore.QReadLocker" title="PySide.QtCore.QReadLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QReadLocker</span></tt></a>  <a class="reference internal" href="QWriteLocker.html#PySide.QtCore.QWriteLocker" title="PySide.QtCore.QWriteLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QWriteLocker</span></tt></a>  <a class="reference internal" href="QMutex.html#PySide.QtCore.QMutex" title="PySide.QtCore.QMutex"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutex</span></tt></a></p>
</div>
</div></blockquote>
<dl class="class">
<dt id="PySide.QtCore.QMutexLocker">
<em class="property">class </em><tt class="descclassname">PySide.QtCore.</tt><tt class="descname">QMutexLocker</tt><big>(</big><em>m</em><big>)</big><a class="headerlink" href="#PySide.QtCore.QMutexLocker" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>m</strong> &#8211; <a class="reference internal" href="QMutex.html#PySide.QtCore.QMutex" title="PySide.QtCore.QMutex"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutex</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Constructs a <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> and locks <tt class="docutils literal"><span class="pre">mutex</span></tt> . The mutex will be unlocked when the <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> is destroyed. If <tt class="docutils literal"><span class="pre">mutex</span></tt> is zero, <a class="reference internal" href="#PySide.QtCore.QMutexLocker" title="PySide.QtCore.QMutexLocker"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutexLocker</span></tt></a> does nothing.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="QMutex.html#PySide.QtCore.PySide.QtCore.QMutex.lock" title="PySide.QtCore.PySide.QtCore.QMutex.lock"><tt class="xref py py-meth docutils literal"><span class="pre">QMutex.lock()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="PySide.QtCore.PySide.QtCore.QMutexLocker.__enter__">
<tt class="descclassname">PySide.QtCore.QMutexLocker.</tt><tt class="descname">__enter__</tt><big>(</big><big>)</big><a class="headerlink" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.__enter__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="PySide.QtCore.PySide.QtCore.QMutexLocker.__exit__">
<tt class="descclassname">PySide.QtCore.QMutexLocker.</tt><tt class="descname">__exit__</tt><big>(</big><em>arg__1</em>, <em>arg__2</em>, <em>arg__3</em><big>)</big><a class="headerlink" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.__exit__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>arg__1</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">PyObject</span></tt></li>
<li><strong>arg__2</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">PyObject</span></tt></li>
<li><strong>arg__3</strong> &#8211; <tt class="xref py py-class docutils literal"><span class="pre">PyObject</span></tt></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="PySide.QtCore.PySide.QtCore.QMutexLocker.mutex">
<tt class="descclassname">PySide.QtCore.QMutexLocker.</tt><tt class="descname">mutex</tt><big>(</big><big>)</big><a class="headerlink" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.mutex" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="QMutex.html#PySide.QtCore.QMutex" title="PySide.QtCore.QMutex"><tt class="xref py py-class docutils literal"><span class="pre">PySide.QtCore.QMutex</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Returns a pointer to the mutex that was locked in the constructor.</p>
</dd></dl>

<dl class="method">
<dt id="PySide.QtCore.PySide.QtCore.QMutexLocker.relock">
<tt class="descclassname">PySide.QtCore.QMutexLocker.</tt><tt class="descname">relock</tt><big>(</big><big>)</big><a class="headerlink" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.relock" title="Permalink to this definition">¶</a></dt>
<dd><p>Relocks an unlocked mutex locker.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.unlock" title="PySide.QtCore.PySide.QtCore.QMutexLocker.unlock"><tt class="xref py py-meth docutils literal"><span class="pre">PySide.QtCore.QMutexLocker.unlock()</span></tt></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="PySide.QtCore.PySide.QtCore.QMutexLocker.unlock">
<tt class="descclassname">PySide.QtCore.QMutexLocker.</tt><tt class="descname">unlock</tt><big>(</big><big>)</big><a class="headerlink" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.unlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Unlocks this mutex locker. You can use <tt class="docutils literal"><span class="pre">relock()</span></tt> to lock it again. It does not need to be locked when destroyed.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#PySide.QtCore.PySide.QtCore.QMutexLocker.relock" title="PySide.QtCore.PySide.QtCore.QMutexLocker.relock"><tt class="xref py py-meth docutils literal"><span class="pre">PySide.QtCore.QMutexLocker.relock()</span></tt></a></p>
</div>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
    <a href="http://www.indt.org.br"><img src="../../_static/logo_indt.jpg" alt="Indt" border="0" /></a>
    <a href="http://www.openbossa.org"><img src="../../_static/logo_openbossa.png" alt="Openbossa" border="0" /></a>
    <a href="http://qt.nokia.com/"><img src="../../_static/logo_qt.png" alt="Qt" border="0" /></a>
    <a href="http://www.python.org"><img src="../../_static/logo_python.jpg" alt="Python" border="0" /></a>
    </div>
</div>
  </body>
</html>